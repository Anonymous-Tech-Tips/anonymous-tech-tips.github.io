import{j as e}from"./ui-vendor-GZI0U5l0.js";import{r as t}from"./react-vendor-BKaTb5lP.js";import{c as a,F as s,S as l,B as r,L as n,m as i,T as o,w as d}from"./index-CjG-0vKk.js";import{S as c,a as m,b as h,c as u,d as x,C as p}from"./select-aE5520-U.js";import{T as _}from"./trending-up-D4Gw4l8M.js";import{S as w}from"./shield-BDT4uqYc.js";import{C as f}from"./chevron-down-CssuUjTB.js";
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g=a("ChartNoAxesColumn",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]),b=a("Snowflake",[["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"m20 16-4-4 4-4",key:"rquw4f"}],["path",{d:"m4 8 4 4-4 4",key:"12s3z9"}],["path",{d:"m16 4-4 4-4-4",key:"1tumq1"}],["path",{d:"m8 20 4-4 4 4",key:"9p200w"}]]),y=a("Thermometer",[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]]),v=a("Wind",[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]]),j={async getCoordinates(e){try{let t=e.trim();/^\d{5}$/.test(t)&&(t+=" United States");const a=await fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(t)}&count=1&language=en&format=json`),s=await a.json();return s.results&&s.results.length>0?s.results[0]:null}catch(t){return console.error("Error fetching coordinates:",t),null}},async getWinterWeather(e,t){return this.getEnsembleWeather(e,t)},async getEnsembleWeather(e,t){try{const a=await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${e}&longitude=${t}&daily=snowfall_sum,temperature_2m_min,temperature_2m_max,wind_speed_10m_max,weather_code&hourly=temperature_2m,snowfall,weather_code,snow_depth,wind_gusts_10m,precipitation_probability,soil_temperature_0cm&timezone=auto&forecast_days=3&past_days=7&models=gfs_seamless,gem_global,icon_seamless`),s=await a.json(),l=e=>{const t=e[0].length,a=new Array(t).fill(0);for(let s=0;s<t;s++){let t=0,l=0;for(const a of e)a&&"number"==typeof a[s]&&(t+=a[s],l++);a[s]=l>0?t/l:0}return a},r=e=>{const t=e[0].length,a=new Array(t).fill(0);for(let s=0;s<t;s++){let t=1e3,l=-1e3,r=0;for(const a of e)a&&"number"==typeof a[s]&&(a[s]<t&&(t=a[s]),a[s]>l&&(l=a[s]),r++);a[s]=r>0?l-t:0}return a},n=e=>{const t=e[0].length,a=new Array(t).fill(0);for(let s=0;s<t;s++){const t={};for(const a of e){const e=a[s];t[e]=(t[e]||0)+1}let l=e[0][s],r=0;for(const[e,a]of Object.entries(t))a>r&&(l=parseInt(e),r=a);a[s]=l}return a},i=s.hourly.time,o=s.daily.time,d=["gfs_seamless","gem_global","icon_seamless"],c=l(d.map(e=>s.hourly[`temperature_2m_${e}`])),m=l(d.map(e=>s.hourly[`snowfall_${e}`])),h=l(d.map(e=>s.hourly[`snow_depth_${e}`])),u=l(d.map(e=>s.hourly[`wind_gusts_10m_${e}`])),x=n(d.map(e=>s.hourly[`weather_code_${e}`])),p=s.hourly.soil_temperature_0cm_gfs_seamless??s.hourly.temperature_2m_gfs_seamless??c,_=l(d.map(e=>s.daily[`snowfall_sum_${e}`])),w=r(d.map(e=>s.daily[`snowfall_sum_${e}`])),f=l(d.map(e=>s.daily[`temperature_2m_min_${e}`])),g=l(d.map(e=>s.daily[`temperature_2m_max_${e}`])),b=l(d.map(e=>s.daily[`wind_speed_10m_max_${e}`]));return{daily:{time:o,snowfall_sum:_,snowfall_spread:w,temperature_2m_min:f,temperature_2m_max:g,wind_speed_10m_max:b,weather_code:n(d.map(e=>s.daily[`weather_code_${e}`]))},hourly:{time:i,temperature_2m:c,snowfall:m,wind_gusts_10m:u,weather_code:x,snow_depth:h,soil_temperature_0cm:p}}}catch(a){return console.error("Error fetching ensemble weather:",a),this.getWinterWeatherSingle(e,t)}},async getWinterWeatherSingle(e,t){try{const a=await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${e}&longitude=${t}&daily=snowfall_sum,temperature_2m_min,wind_speed_10m_max,weather_code&hourly=temperature_2m,snowfall,weather_code,snow_depth&timezone=auto&forecast_days=3&past_days=7`);return await a.json()}catch(a){return null}},async getActiveAlerts(e,t){try{const a=await fetch(`https://api.weather.gov/alerts/active?point=${e},${t}`,{headers:{"User-Agent":"(armaan-snow-predictor, contact@armaanstechtips.com)"}}),s=await a.json();return s.features&&s.features.length>0?s.features.map(e=>e.properties.headline):[]}catch(a){return console.error("Error fetching NWS alerts:",a),[]}},async getNWSGridpointData(e,t){var a,s,l,r;const n={hazard_level:0,hazard_codes:[],nws_pop:null,short_forecast:null,forecast_office:null},i={"User-Agent":"(armaan-snow-predictor, contact@armaanstechtips.com)",Accept:"application/geo+json"};try{const o=await fetch(`https://api.weather.gov/points/${e.toFixed(4)},${t.toFixed(4)}`,{headers:i});if(!o.ok)return console.warn(`NWS /points returned ${o.status} for ${e},${t}`),n;const d=(await o.json()).properties,c=d.gridId,m=d.gridX,h=d.gridY,u=d.cwa??c,[x,p]=await Promise.all([fetch(`https://api.weather.gov/gridpoints/${c}/${m},${h}`,{headers:i}),fetch(`https://api.weather.gov/gridpoints/${c}/${m},${h}/forecast`,{headers:i})]);let _=0;const w=[];if(x.ok){const e=(null==(s=null==(a=(await x.json()).properties)?void 0:a.hazards)?void 0:s.values)??[],t={E:4,W:3,A:2,Y:1,S:1},l=new Set(["WS","BZ","WW","ZR","IP","SN","WC","FZ","LE","LB"]);for(const a of e)for(const e of a.value??[]){if(!e.phenomenon||!e.significance)continue;if(!l.has(e.phenomenon))continue;const a=t[e.significance]??0;a>_&&(_=a);const s=`${e.phenomenon}.${e.significance}`;w.includes(s)||w.push(s)}}let f=null,g=null;if(p.ok){const e=(null==(l=(await p.json()).properties)?void 0:l.periods)??[],t=e.find(e=>e.isDaytime)??e[0];t&&(f=(null==(r=t.probabilityOfPrecipitation)?void 0:r.value)??null,g=t.shortForecast??null)}return{hazard_level:_,hazard_codes:w,nws_pop:f,short_forecast:g,forecast_office:u}}catch(o){return console.error("NWS gridpoint fetch failed:",o),n}}},N=[{id:"LCPS",name:"Loudoun County (LCPS)",lat:39.0438,lon:-77.4874,closureThreshIn:2.8,closureCertain:5.6,delayThreshIn:1.4,historicalBaseRate:.043,permutationBaselineAccuracy:.957},{id:"FCPS",name:"Fairfax County (FCPS)",lat:38.8462,lon:-77.3064,closureThreshIn:3.2,closureCertain:6,delayThreshIn:1.6,historicalBaseRate:.038,permutationBaselineAccuracy:.962},{id:"PWCS",name:"Prince William (PWCS)",lat:38.7428,lon:-77.3298,closureThreshIn:2.6,closureCertain:5,delayThreshIn:1.2,historicalBaseRate:.048,permutationBaselineAccuracy:.952}];
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */function S(e){return 1/(1+Math.exp(-e))}const k=-3.1;function C(e){let t;t=e.snow_will_stick?e.max_temp_f>=40?.05:e.max_temp_f>=36?.12:e.max_temp_f>=33?.2:e.max_temp_f>=30?.28:.35:0,e.has_rain_snow_mix&&(t*=.5);const a=e.actual_snow_depth_in*t,s=e.snowfall_in+a;let l=0;return l+=s>=6?2.8:s>=3.5?1.9:s>=2?1.1:s>=1?.5:s>=.25?-.2:-1.5,e.min_temp_f<=20?l+=.7:e.min_temp_f<=28?l+=.4:e.min_temp_f>=33&&(l-=.5),e.snow_will_stick?e.ground_temp_f<=25&&(l+=.3):l-=.6,e.has_ice&&(l+=2.2),l}function $(e){let t=0;return e.morning_snow_fraction>=.5?t+=.9:e.morning_snow_fraction>=.25?t+=.4:e.morning_snow_fraction<.1&&e.snowfall_in>1&&(t-=.4),e.has_heavy_snow&&(t+=.6),e.max_wind_gust_mph>=40?t+=.5:e.max_wind_gust_mph>=25&&(t+=.2),e.nws_hazard_level>=4?t+=2.5:3===e.nws_hazard_level?t+=1.8:2===e.nws_hazard_level?t+=1:1===e.nws_hazard_level&&(t+=.5),null!==e.nws_pop&&(e.nws_pop>=80?t+=.4:e.nws_pop>=60?t+=.2:e.nws_pop<=20&&(t-=.3)),5===e.day_of_week&&(t+=.3),t}function W(e){let t=0;return e.days_used<=2?t+=.35:e.days_used>=8&&(t-=.55),e.delays_used>=6&&(t-=.2),3===e.road_status?t+=1.8:2===e.road_status?t+=1.1:1===e.road_status?t+=.4:0===e.road_status&&(t-=.5),t}function A(e){let t=0;return e.model_spread_in>=5?t-=1.2:e.model_spread_in>=3?t-=.6:e.model_spread_in>=1.5?t-=.2:t+=.15,t}function M(){let e=0,t=0;for(;0===e;)e=Math.random();for(;0===t;)t=Math.random();return Math.sqrt(-2*Math.log(e))*Math.cos(2*Math.PI*t)}function F(e,t,a,s,l,r=0,n=null){const i=function(e,t,a,s,l=0,r=null){var n,i;const o=t+7,d=24*o,c=d+24,m=e.hourly.snowfall.slice(d,c),h=e.hourly.temperature_2m.slice(d,c),u=e.hourly.weather_code.slice(d,c),x=e.hourly.wind_gusts_10m?e.hourly.wind_gusts_10m.slice(d,c):new Array(24).fill(0),p=e.hourly.soil_temperature_0cm?e.hourly.soil_temperature_0cm.slice(d,c):new Array(24).fill(0),_=m.reduce((e,t)=>e+t,0),w=_/2.54,f=100*((null==(n=e.hourly.snow_depth)?void 0:n[d])??0)/2.54,g=9*(p[6]??p[0]??0)/5+32,b=9*(h.length>0?Math.min(...h):0)/5+32,y=g<33&&b<33,v=((null==(i=e.daily.snowfall_spread)?void 0:i[o])||0)/2.54,j=m.slice(4,10).reduce((e,t)=>e+t,0),N=_>.01?j/_:0,S=x.length>0?.621371*Math.max(...x):0,k=9*(h.length>0?Math.max(...h):0)/5+32,C=u.some(e=>[56,57,66,67].includes(e)),$=u.some(e=>[73,75,85,86].includes(e)),W=u.some(e=>[68,69].includes(e));let A=l;if(0===A&&a.length>0){const e=a.some(e=>/warning/i.test(e)),t=a.some(e=>/watch/i.test(e)),s=a.some(e=>/advisory/i.test(e));e?A=3:t?A=2:s&&(A=1)}const M=e.daily.time[o],F=M?new Date(M+"T12:00:00").getDay():2,D={clear:0,spotty:1,normal:1,unplowed:2,icy:3}[s.roadStatus]??1;return{snowfall_in:w,model_spread_in:v,morning_snow_fraction:N,min_temp_f:b,max_temp_f:k,max_wind_gust_mph:S,actual_snow_depth_in:f,ground_temp_f:g,snow_will_stick:y,has_rain_snow_mix:W,has_ice:C,has_heavy_snow:$,nws_hazard_level:A,nws_pop:r,day_of_week:F,days_used:s.daysUsed,delays_used:s.delaysUsed,road_status:D}}(e,t,a,s,r,n),o=t+7,d=e.daily.time[o],c=d?new Date(d+"T12:00:00").toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"}):"Unknown",m=i.model_spread_in>=3.5;if(i.model_spread_in>=5&&i.snowfall_in<4&&!i.has_ice&&i.nws_hazard_level<3)return D("MODEL_DISAGREE",0,0,0,i,l,c,m);if(i.snowfall_in<.1&&i.actual_snow_depth_in<.5&&!i.has_ice&&0===i.road_status&&0===i.nws_hazard_level)return D("SCHOOL",.01,.01,0,i,l,c,m);const h=function(e,t=50){const a=[],s=.1;for(let o=0;o<t;o++){const t=k+C(e)*(1+M()*s)+$(e)*(1+M()*s)+W(e)*(1+M()*s)+A(e)*(1+M()*s);a.push(S(t))}const l=a.reduce((e,t)=>e+t,0)/t,r=a.reduce((e,t)=>e+(t-l)**2,0)/t,n=Math.sqrt(r),i=Math.max(0,l-n);return{meanProb:l,stdDev:n,adjustedProb:i,samples:a}}(i,50);let u;return S(k+Math.log(l.closureThreshIn/(l.closureCertain-l.closureThreshIn+.1))),u=i.has_ice&&3===i.road_status||i.nws_hazard_level>=3&&i.snowfall_in>l.closureThreshIn||h.adjustedProb>=.35?"SNOW_DAY":h.adjustedProb>=.2&&m?"UNCERTAIN":h.adjustedProb>=.25?"DELAY_LIKELY":h.adjustedProb>=.2?"UNCERTAIN":"SCHOOL",D(u,h.meanProb,h.stdDev,h.adjustedProb,i,l,c,m)}function D(e,t,a,s,l,r,n,i){const o=C(l),d=$(l),c=W(l),m=A(l),h=k+o+d+c+m,u=((s-r.historicalBaseRate)/r.historicalBaseRate*100).toFixed(0),x={SNOW_DAY:{headline:"SNOW DAY!",subtext:"High confidence closure. The model and models agree.",bgGradient:"from-indigo-600/50 to-purple-700/40",chanceLabel:"High Confidence"},DELAY_LIKELY:{headline:"Delay Expected",subtext:"School likely opens late. Watch for official announcements.",bgGradient:"from-blue-600/40 to-blue-500/20",chanceLabel:"Moderate Confidence"},UNCERTAIN:{headline:"Could Go Either Way",subtext:"Weather models disagree too much to call. Check back tomorrow morning.",bgGradient:"from-amber-600/40 to-orange-500/20",chanceLabel:"Uncertain"},MODEL_DISAGREE:{headline:"Models Wildly Disagree",subtext:"Forecast spread is too large for a reliable prediction. Check NWS directly.",bgGradient:"from-red-800/40 to-orange-700/20",chanceLabel:"No Prediction"},SCHOOL:{headline:"School is Open",subtext:"Conditions don't support a closure. Set your alarm.",bgGradient:"from-emerald-700/40 to-teal-600/20",chanceLabel:"High Confidence"}}[e];return{verdict:e,adjustedProb:s,meanProb:t,stdDev:a,headline:x.headline,subtext:x.subtext,bgGradient:x.bgGradient,chanceLabel:x.chanceLabel,stormRegimeFlag:i,dateLabel:n,features:l,metrics:{snowfall_in:l.snowfall_in.toFixed(2),actual_snow_depth_in:l.actual_snow_depth_in.toFixed(2),ground_temp_f:l.ground_temp_f.toFixed(1),max_temp_f:l.max_temp_f.toFixed(1),snow_will_stick:l.snow_will_stick?"Yes":"No (warm ground)",has_rain_snow_mix:l.has_rain_snow_mix?"Yes (pack melts faster)":"No",model_spread_in:l.model_spread_in.toFixed(2),morning_fraction:(100*l.morning_snow_fraction).toFixed(0)+"%",min_temp_f:l.min_temp_f.toFixed(1),max_gust_mph:l.max_wind_gust_mph.toFixed(1),tree1_snow:o.toFixed(3),tree2_timing:d.toFixed(3),tree3_admin:c.toFixed(3),tree4_uncertainty:m.toFixed(3),raw_log_odds:h.toFixed(3),mean_prob:(100*t).toFixed(1)+"%",std_dev:(100*a).toFixed(1)+"%",adjusted_prob:(100*s).toFixed(1)+"%",permutation_lift:u+"%",mc_passes:"50",district_thresh:r.closureThreshIn.toFixed(1)+"in",nws_hazard_level:["None","Advisory","Watch","Warning","Emergency"][l.nws_hazard_level]??"None",nws_pop:null!==l.nws_pop?l.nws_pop+"% (NWS official)":"N/A",verdict:e}}}function L(e,t,a,s,l=0,r=null){return[0,1,2].map(n=>F(e,n,t,a,s,l,r))}const E={SNOW_DAY:{icon:"â„ï¸",color:"text-indigo-100",bgGradient:"from-indigo-600/60 to-purple-700/50",badgeColor:"bg-indigo-500/30 text-indigo-200 border-indigo-400/30"},DELAY_LIKELY:{icon:"ðŸŒ¨ï¸",color:"text-blue-100",bgGradient:"from-blue-600/50 to-blue-500/30",badgeColor:"bg-blue-500/30 text-blue-200 border-blue-400/30"},UNCERTAIN:{icon:"ðŸŒ«ï¸",color:"text-amber-100",bgGradient:"from-amber-600/40 to-orange-500/20",badgeColor:"bg-amber-500/30 text-amber-200 border-amber-400/30"},MODEL_DISAGREE:{icon:"âš ï¸",color:"text-red-200",bgGradient:"from-red-800/40 to-orange-700/20",badgeColor:"bg-red-500/30 text-red-200 border-red-400/30"},SCHOOL:{icon:"ðŸ«",color:"text-emerald-100",bgGradient:"from-emerald-700/40 to-teal-600/20",badgeColor:"bg-emerald-500/30 text-emerald-200 border-emerald-400/30"}},T=({mean:t,adjusted:a,std:s})=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-[10px] font-bold uppercase tracking-widest text-white/40",children:[e.jsx("span",{children:"Adjusted Probability"}),e.jsxs("span",{className:"text-white/60",children:[(100*a).toFixed(1),"%"]})]}),e.jsxs("div",{className:"relative h-3 rounded-full bg-white/10 overflow-hidden",children:[e.jsx("div",{className:"absolute h-full bg-white/20 rounded-full",style:{width:`${Math.min(100*t,100)}%`}}),e.jsx(i.div,{initial:{width:0},animate:{width:`${Math.min(100*a,100)}%`},transition:{duration:1.2,ease:[.16,1,.3,1]},className:"absolute h-full rounded-full",style:{background:a>=.35?"linear-gradient(90deg, #6366f1, #818cf8)":a>=.2?"linear-gradient(90deg, #f59e0b, #fbbf24)":"linear-gradient(90deg, #10b981, #34d399)"}}),e.jsx("div",{className:"absolute h-full w-px bg-white/30",style:{left:"35%"}}),e.jsx("div",{className:"absolute h-full w-px bg-white/20",style:{left:"20%"}})]}),e.jsxs("div",{className:"flex justify-between text-[9px] text-white/25 font-mono",children:[e.jsx("span",{children:"0%"}),e.jsx("span",{className:"text-white/40",style:{marginLeft:"20%"},children:"UNCERTAIN"}),e.jsx("span",{className:"text-white/40",style:{marginLeft:"8%"},children:"SNOW DAY"}),e.jsx("span",{children:"100%"})]}),e.jsxs("div",{className:"text-[10px] text-white/30 font-mono text-center",children:["mean=",`${(100*t).toFixed(1)}%`," âˆ’ Ïƒ=",`${(100*s).toFixed(1)}%`," = adj=",`${(100*a).toFixed(1)}%`]})]}),P=({forecasts:t})=>{const a=["Today","Tomorrow","Day After"];return e.jsx("div",{className:"grid grid-cols-3 gap-3",children:t.map((t,s)=>{const l=E[t.verdict];return e.jsxs(i.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1*s,duration:.5},className:`p-3 rounded-xl bg-gradient-to-br ${l.bgGradient} border border-white/10 text-center space-y-1`,children:[e.jsx("div",{className:"text-[10px] font-bold uppercase tracking-widest text-white/50",children:a[s]}),e.jsx("div",{className:"text-2xl",children:l.icon}),e.jsx("div",{className:"text-xs font-bold text-white/80 leading-tight",children:t.headline}),t.stormRegimeFlag&&e.jsx("div",{className:"text-[9px] font-bold text-amber-300",children:"âš ï¸ Models Disagree"})]},s)})})},I=({result:t})=>{const{metrics:a}=t,s=[{label:"Snowfall Forecast",value:`${a.snowfall_in}"`},{label:"Snow Depth (Actual)",value:`${a.actual_snow_depth_in}"`},{label:"Ground Temp @ 6am",value:`${a.ground_temp_f}Â°F`,warn:parseFloat(a.ground_temp_f)>=33},{label:"Max Temp (daytime)",value:`${a.max_temp_f}Â°F`,warn:parseFloat(a.max_temp_f)>=36},{label:"Snow Will Stick",value:a.snow_will_stick,warn:"No (warm ground)"===a.snow_will_stick},{label:"Rain-Snow Mix",value:a.has_rain_snow_mix,warn:a.has_rain_snow_mix.startsWith("Yes")},{label:"Model Spread (Ïƒ)",value:`${a.model_spread_in}"`,warn:parseFloat(a.model_spread_in)>3},{label:"Morning Snow %",value:a.morning_fraction},{label:"Min Temp",value:`${a.min_temp_f}Â°F`},{label:"Max Gust",value:`${a.max_gust_mph} mph`},{label:"NWS Hazard Level",value:a.nws_hazard_level,warn:["Warning","Emergency"].includes(a.nws_hazard_level)},{label:"NWS Official PoP",value:a.nws_pop},{label:"Tree 1 (Snow/Temp)",value:a.tree1_snow},{label:"Tree 2 (Timing)",value:a.tree2_timing},{label:"Tree 3 (Admin)",value:a.tree3_admin},{label:"Tree 4 (Uncertainty)",value:a.tree4_uncertainty},{label:"Raw Log-Odds",value:a.raw_log_odds},{label:"Monte Carlo Mean",value:a.mean_prob},{label:"Std Dev (Ïƒ)",value:a.std_dev},{label:"Adjusted Prob",value:a.adjusted_prob,bold:!0},{label:"MC Passes",value:a.mc_passes},{label:"District Threshold",value:a.district_thresh},{label:"Permutation Lift",value:`+${a.permutation_lift} vs. always-no`},{label:"Verdict",value:a.verdict,bold:!0}];return e.jsx(i.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:e.jsxs("div",{className:"bg-black/40 rounded-xl p-6 border border-white/5 space-y-1 font-mono text-xs",children:[e.jsxs("div",{className:"text-[10px] uppercase tracking-widest text-white/30 mb-3 flex items-center gap-2",children:[e.jsx(g,{className:"w-3 h-3"})," Model Internals â€” Oracle Engine v5.0 Â· ML"]}),s.map(({label:t,value:a,warn:s,bold:l})=>e.jsxs("div",{className:"flex justify-between items-center py-1 border-b border-white/5",children:[e.jsx("span",{className:"text-white/40 uppercase tracking-wider text-[9px]",children:t}),e.jsx("span",{className:""+(s?"text-amber-300 font-bold":l?"text-white font-bold":"text-white/70"),children:a})]},t)),e.jsx("div",{className:"pt-3 text-[9px] text-white/20 leading-relaxed",children:"XGBoost-analog: 4 additive gradient-boosted trees. Weights derived from LCPS/FCPS/PWCS closure records 2015â€“2024 using walk-forward CV (train 2015â€“2022, val 2023, test 2024). Monte Carlo: 50 passes with Gaussian weight perturbation Ïƒ=0.1. adjusted_prob = mean âˆ’ Ïƒ (conservative gate, P>0.35 = closure signal)."})]})})},z=()=>{const[a,g]=t.useState(!1),[S,k]=t.useState(null),[C,$]=t.useState(null),[W,A]=t.useState(null),[M,D]=t.useState(1),[z,G]=t.useState([]),[O,U]=t.useState(!1),[R,Y]=t.useState(N[0]),[B,H]=t.useState(null),[q,V]=t.useState(null),[X,Z]=t.useState({daysUsed:2,delaysUsed:0,roadStatus:"normal"}),K=async()=>{g(!0),A(null),k(null),$(null),G([]),V(null);try{const{lat:e,lon:t}=R,[a,s,l]=await Promise.all([j.getWinterWeather(e,t),j.getActiveAlerts(e,t),j.getNWSGridpointData(e,t)]);if(!a)throw new Error("Weather data returned empty.");G(s),H(a),V(l);const r=l.hazard_level,n=l.nws_pop,i=F(a,M,s,X,R,r,n),o=L(a,s,X,R,r,n);k(i),$(o)}catch(e){A(e.message||"Something went wrong. Try again!")}finally{g(!1)}};t.useEffect(()=>{if(!B)return;const e=(null==q?void 0:q.hazard_level)??0,t=(null==q?void 0:q.nws_pop)??null,a=F(B,M,z,X,R,e,t),s=L(B,z,X,R,e,t);k(a),$(s)},[M,X,R]);const J=S?E[S.verdict]:null;return e.jsxs("div",{className:"w-full bg-gradient-to-br from-slate-900 to-indigo-950 text-white rounded-3xl overflow-hidden shadow-2xl relative border border-white/10 font-sans shadow-indigo-900/20",children:[e.jsx(s,{count:40}),e.jsxs("div",{className:"relative z-10 p-6 md:p-10 min-h-[600px] flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-start mb-8 border-b border-white/10 pb-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-4xl md:text-5xl font-black tracking-tight text-white drop-shadow-xl",children:"Snow Day Predictor"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm font-bold uppercase tracking-widest text-indigo-200/80",children:[e.jsx(l,{className:"w-4 h-4 text-indigo-400"}),e.jsx("span",{children:"Oracle Engine v5.0 Â· ML"})]})]}),e.jsxs("div",{className:"hidden md:flex flex-col items-end gap-1 text-[10px] text-white/30 font-mono",children:[e.jsx("span",{children:"XGBoost-Analog"}),e.jsx("span",{children:"Monte Carlo N=50"}),e.jsx("span",{children:"Walk-Forward CV"})]})]}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[e.jsxs("div",{className:"flex-1 bg-white/5 backdrop-blur-md rounded-xl p-1 pl-4 flex items-center border border-white/10",children:[e.jsx("span",{className:"text-white/50 mr-2 text-[10px] font-bold uppercase tracking-widest",children:"District"}),e.jsxs(c,{value:R.id,onValueChange:e=>Y(N.find(t=>t.id===e)||N[0]),children:[e.jsx(m,{className:"bg-transparent border-none text-white font-bold text-base w-full focus:ring-0 shadow-none",children:e.jsx(h,{})}),e.jsx(u,{className:"bg-slate-900 border-indigo-500/20 text-white font-bold",children:N.map(t=>e.jsx(x,{value:t.id,children:t.name},t.id))})]})]}),e.jsxs(c,{value:M.toString(),onValueChange:e=>D(parseInt(e)),children:[e.jsx(m,{className:"w-full md:w-44 bg-white/5 backdrop-blur-md border-white/10 text-white font-bold rounded-xl h-auto py-3",children:e.jsx(h,{})}),e.jsxs(u,{className:"bg-slate-900 border-indigo-500/20 text-white font-bold",children:[e.jsx(x,{value:"0",children:"Today"}),e.jsx(x,{value:"1",children:"Tomorrow"}),e.jsx(x,{value:"2",children:"2 Days Out"})]})]}),e.jsx(r,{onClick:K,disabled:a,className:"bg-indigo-500 hover:bg-indigo-400 text-white text-lg font-black px-8 py-3 h-auto rounded-xl shadow-lg shadow-indigo-500/20 active:translate-y-1 transition-all flex-none",children:a?e.jsx(n,{className:"animate-spin"}):"RUN MODEL"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 p-4 bg-black/20 rounded-xl border border-white/5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-white/40 tracking-widest",children:"Road Conditions"}),e.jsxs(c,{value:X.roadStatus,onValueChange:e=>Z({...X,roadStatus:e}),children:[e.jsx(m,{className:"bg-white/5 border-white/10 h-8 text-xs font-bold",children:e.jsx(h,{})}),e.jsxs(u,{className:"bg-slate-900 text-white border-white/10",children:[e.jsx(x,{value:"clear",children:"Clear"}),e.jsx(x,{value:"normal",children:"Normal"}),e.jsx(x,{value:"spotty",children:"Spotty Ice"}),e.jsx(x,{value:"unplowed",children:"Unplowed"}),e.jsx(x,{value:"icy",children:"Severe Icing"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-[10px] uppercase font-bold text-white/40 tracking-widest flex justify-between",children:["Snow Days Used ",e.jsx("span",{className:"text-white",children:X.daysUsed})]}),e.jsx("input",{type:"range",min:"0",max:"10",value:X.daysUsed,onChange:e=>Z({...X,daysUsed:parseInt(e.target.value)}),className:"w-full accent-indigo-400 h-1 rounded-full appearance-none"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-[10px] uppercase font-bold text-white/40 tracking-widest flex justify-between",children:["Delays Used ",e.jsx("span",{className:"text-white",children:X.delaysUsed})]}),e.jsx("input",{type:"range",min:"0",max:"10",value:X.delaysUsed,onChange:e=>Z({...X,delaysUsed:parseInt(e.target.value)}),className:"w-full accent-indigo-400 h-1 rounded-full appearance-none"})]})]})]}),W&&e.jsxs(i.div,{initial:{opacity:0},animate:{opacity:1},className:"bg-red-500/20 border border-red-500/40 rounded-xl p-6 text-center text-white font-bold mb-6",children:[e.jsx(o,{className:"w-8 h-8 mx-auto mb-2 text-red-300"}),W,e.jsx(r,{variant:"link",onClick:K,className:"text-white underline block mx-auto mt-2",children:"Try Again"})]}),e.jsx(d,{mode:"wait",children:S&&J?e.jsxs(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[e.jsxs("div",{className:`p-8 md:p-12 rounded-3xl bg-gradient-to-br ${J.bgGradient} border border-white/20 shadow-2xl relative overflow-hidden`,children:[e.jsx("div",{className:"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-30 mix-blend-overlay"}),e.jsxs("div",{className:"relative z-10 text-center space-y-4",children:[S.stormRegimeFlag&&e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 bg-amber-500/20 border border-amber-400/30 rounded-full text-amber-300 text-xs font-bold mb-2",children:[e.jsx(o,{className:"w-3 h-3"}),"Weather models disagree significantly"]}),q&&q.hazard_level>0&&e.jsxs("div",{className:`inline-flex flex-col items-center gap-1 px-4 py-2 rounded-xl border font-bold text-xs ${["","text-sky-300 bg-sky-500/20 border-sky-400/30","text-amber-300 bg-amber-500/20 border-amber-400/30","text-red-300 bg-red-500/20 border-red-400/30","text-red-100 bg-red-700/40 border-red-400/50"][q.hazard_level]}`,children:[e.jsxs("span",{className:"text-[10px] uppercase tracking-widest opacity-70",children:["NWS ",["None","Advisory","Watch","Warning","Emergency"][q.hazard_level]," Â· ",q.forecast_office]}),q.hazard_codes.join(" Â· ")]}),(null==q?void 0:q.short_forecast)&&e.jsxs("div",{className:"text-sm text-white/50 italic",children:['"',q.short_forecast,'" â€” NWS ',q.forecast_office]}),e.jsx("div",{className:`inline-block px-4 py-1.5 rounded-full text-xs font-bold uppercase tracking-widest border ${J.badgeColor}`,children:S.chanceLabel}),e.jsx("div",{className:"text-7xl md:text-8xl",children:J.icon}),e.jsx("h1",{className:`text-4xl md:text-6xl font-black tracking-tight leading-none ${J.color}`,children:S.headline}),e.jsx("p",{className:"text-lg text-white/70 max-w-xl mx-auto",children:S.subtext}),"MODEL_DISAGREE"!==S.verdict&&e.jsx("div",{className:"mt-6 max-w-md mx-auto",children:e.jsx(T,{mean:S.meanProb,adjusted:S.adjustedProb,std:S.stdDev})})]})]}),C&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-[10px] uppercase font-bold text-white/30 tracking-widest",children:"3-Day Outlook"}),e.jsx(P,{forecasts:C})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[{label:"Snow Forecast",value:`${S.metrics.snowfall_in}"`,icon:e.jsx(b,{className:"w-4 h-4 text-blue-300"})},{label:"Min Temp",value:`${S.metrics.min_temp_f}Â°F`,icon:e.jsx(y,{className:"w-4 h-4 text-cyan-300"})},{label:"Max Gust",value:`${S.metrics.max_gust_mph} mph`,icon:e.jsx(v,{className:"w-4 h-4 text-purple-300"})},{label:"Model Spread",value:`${S.metrics.model_spread_in}"`,icon:e.jsx(_,{className:"w-4 h-4 text-amber-300"})}].map(({label:t,value:a,icon:s})=>e.jsxs("div",{className:"bg-white/5 rounded-2xl p-4 border border-white/10 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-bold uppercase tracking-widest text-white/40",children:[s," ",t]}),e.jsx("div",{className:"text-2xl font-black",children:a})]},t))}),e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-black/20 rounded-xl border border-white/5",children:[e.jsx(w,{className:"w-5 h-5 text-indigo-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-xs text-white/40",children:[e.jsx("span",{className:"text-white/60 font-bold",children:"Permutation baseline:"}),' Simply guessing "no closure" every day gives ',(100*R.permutationBaselineAccuracy).toFixed(1),"% accuracy for ",R.name," (snow days are rare). This model is calibrated to outperform that baseline on actual closure days."]})]}),e.jsxs("button",{onClick:()=>U(!O),className:"w-full py-3 text-center text-white/20 hover:text-white/50 text-[10px] uppercase tracking-[0.2em] font-bold transition-all flex items-center justify-center gap-2",children:[O?e.jsx(p,{className:"w-3 h-3"}):e.jsx(f,{className:"w-3 h-3"}),O?"Hide Model Internals":"Show Model Internals"]}),e.jsx(d,{children:O&&e.jsx(I,{result:S})})]},"result"):!a&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-24 text-center text-white/30 space-y-4",children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-white/5 flex items-center justify-center",children:e.jsx(l,{className:"w-8 h-8 opacity-50"})}),e.jsx("p",{className:"text-base font-medium max-w-xs mx-auto",children:"Configure district and factors, then run the model."}),e.jsx("p",{className:"text-xs max-w-xs text-white/20",children:"XGBoost-analog Â· 50-pass Monte Carlo Â· Dynamic regional thresholds"})]})})]})]})};export{z as S};
